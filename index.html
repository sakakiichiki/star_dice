<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星骰篩選網頁</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .result-area {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">星骰篩選系統</h1>

        <!-- Filter Section -->
        <div class="row mt-4">
            <div class="col-md-3">
                <label for="zodiac">星座</label>
                <select id="zodiac" class="form-control">
                    <option value="">選擇星座</option>
                    <!-- Add zodiac options here -->
                </select>
            </div>
            <div class="col-md-3">
                <label for="planet">星球</label>
                <select id="planet" class="form-control">
                    <option value="">選擇星球</option>
                    <!-- Add planet options here -->
                </select>
            </div>
            <div class="col-md-3">
                <label for="gender">性別</label>
                <select id="gender" class="form-control">
                    <option value="">選擇性別</option>
                    <option value="male">男性</option>
                    <option value="female">女性</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="house">宮位</label>
                <select id="house" class="form-control">
                    <option value="">選擇宮位</option>
                    <!-- Add house options here -->
                </select>
            </div>
        </div>

        <!-- Result Areas -->
        <div class="result-area" id="symbolArea">
            <h4>宮位象徵篩選後顯示區</h4>
            <div id="symbolResult">請選擇條件後顯示內容。</div>
        </div>

        <div class="result-area" id="nodeEffectArea">
            <h4>南北交點影響的顯示區</h4>
            <div id="nodeEffectResult">請選擇條件後顯示內容。</div>
        </div>

        <div class="result-area" id="mainRecommendationArea">
            <h4>主推薦商品篩選後顯示區</h4>
            <div id="mainRecommendationResult">請選擇條件後顯示內容。</div>
        </div>

        <div class="result-area" id="suggestionArea">
            <h4>建議商品篩選後顯示區</h4>
            <div id="suggestionResult">請選擇條件後顯示內容。</div>
        </div>
    </div>

    <script>
        // 假設 data 是從 "data" 工作表中取得的資料範例
        const data = [
            { zodiac: "牡羊座", planet: "火星", gender: "male", house: "第一宮", symbol: "自我與外貌", nodeEffect: "積極與挑戰", mainProduct: "紅色水晶", suggestedProduct: "運動裝" },
            { zodiac: "金牛座", planet: "金星", gender: "female", house: "第二宮", symbol: "財富與資源", nodeEffect: "穩定與安全", mainProduct: "翡翠項鍊", suggestedProduct: "舒適家居用品" },
            // Add more data rows here
        ];

        // 動態生成篩選選項
        const zodiacSelect = document.getElementById("zodiac");
        const planetSelect = document.getElementById("planet");
        const houseSelect = document.getElementById("house");

        // 獲取唯一的星座、星球、宮位值來填充選單
        const zodiacs = [...new Set(data.map(d => d.zodiac))];
        const planets = [...new Set(data.map(d => d.planet))];
        const houses = [...new Set(data.map(d => d.house))];

        zodiacs.forEach(z => zodiacSelect.innerHTML += `<option value="${z}">${z}</option>`);
        planets.forEach(p => planetSelect.innerHTML += `<option value="${p}">${p}</option>`);
        houses.forEach(h => houseSelect.innerHTML += `<option value="${h}">${h}</option>`);

        // 篩選並顯示結果
        function filterData() {
            const selectedZodiac = zodiacSelect.value;
            const selectedPlanet = planetSelect.value;
            const selectedGender = document.getElementById("gender").value;
            const selectedHouse = houseSelect.value;

            const filteredData = data.find(d => 
                (selectedZodiac === "" || d.zodiac === selectedZodiac) &&
                (selectedPlanet === "" || d.planet === selectedPlanet) &&
                (selectedGender === "" || d.gender === selectedGender) &&
                (selectedHouse === "" || d.house === selectedHouse)
            );

            // 顯示篩選結果
            document.getElementById("symbolResult").textContent = filteredData ? filteredData.symbol : "無符合條件的結果";
            document.getElementById("nodeEffectResult").textContent = filteredData ? filteredData.nodeEffect : "無符合條件的結果";
            document.getElementById("mainRecommendationResult").textContent = filteredData ? filteredData.mainProduct : "無符合條件的結果";
            document.getElementById("suggestionResult").textContent = filteredData ? filteredData.suggestedProduct : "無符合條件的結果";
        }

        // 綁定下拉選單的篩選事件
        document.querySelectorAll("select").forEach(select => select.addEventListener("change", filterData));
    </script>
</body>
</html>
