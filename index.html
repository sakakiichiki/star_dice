<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星骰-ORIGIN大葉</title>
    <style>
        body {
            font-family: Microsoft JhengHei;
            line-height: 1.6;
            margin: 20px;
        }
        .container {
            display: flex;
            flex-direction: row;
            gap: 40px;
            flex-wrap: wrap; /* 支援行內換行 */
        }
        .form-container, .recommend-container {
            flex: 1;
            min-width: 300px; /* 避免過小的寬度 */
        }
        select, input[type="text"] {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .form-container, .recommend-container {
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 8px;
        }
        .product-list, .suggested-products {
            list-style: none;
            padding-left: 0;
        }

        .product-list li, .suggested-products li {
            margin: 8px 0;
        }

        /* 統一樣式的標題設定 */
        .unified-title {
            font-size: 16px;
            font-weight: bold;
        }

        /* Media Query for responsive design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="form-container">
        <h2>選擇資訊</h2>
        <form id="selectionForm">
            <label for="constellation">星座</label>
            <select id="constellation">
                <option value="">請選擇</option>
                <option value="牡羊座♈︎">牡羊座♈︎</option>
                <option value="金牛座♉︎">金牛座♉︎</option>
                <option value="雙子座♊︎">雙子座♊︎</option>
                <option value="巨蟹座♋︎">巨蟹座♋︎</option>
                <option value="獅子座♌︎">獅子座♌︎</option>
                <option value="處女座♍︎">處女座♍︎</option>
                <option value="天秤座♎︎">天秤座♎︎</option>
                <option value="天蠍座♏︎">天蠍座♏︎</option>
                <option value="射手座♐︎">射手座♐︎</option>
                <option value="摩羯座♑︎">摩羯座♑︎</option>
                <option value="水瓶座♒︎">水瓶座♒︎</option>
                <option value="雙魚座♓︎">雙魚座♓︎</option>
            </select>

            <label for="planet">星球</label>
            <select id="planet">
                <option value="">請選擇</option>
                <option value="太陽☉">太陽☉</option>
                <option value="月亮☽︎">月亮☽︎</option>
                <option value="水星☿">水星☿</option>
                <option value="金星♀">金星♀</option>
                <option value="火星♂">火星♂</option>
                <option value="木星♃">木星♃</option>
                <option value="土星♄">土星♄</option>
                <option value="天王星♅">天王星♅</option>
                <option value="海王星♆">海王星♆</option>
                <option value="冥王星">冥王星</option>
                <option value="北交點☊">北交點☊</option>
                <option value="南交點☋">南交點☋</option>
            </select>

            <label for="gender">性別</label>
            <select id="gender">
                <option value="">請選擇</option>
                <option value="女">女</option>
                <option value="男">男</option>
            </select>

            <label for="position">宮位</label>
            <select id="position">
                <option value="">請選擇</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select>
        </form>
    </div>

    <div class="recommend-container">
        <h2>查詢結果</h2>
        <h3 class="unified-title">南北交點影響</h3>
        <ul id="nodeEffectList" class="suggested-products"></ul>

        <h3 class="unified-title">宮位象徵</h3>
        <ul id="houseSymbolList" class="product-list"></ul>

        <h3 class="unified-title">推薦商品</h3>
        <ul id="recommendedProductsList" class="suggested-products"></ul>

        <h3 class="unified-title">建議商品</h3>
        <ul id="suggestedProductsList" class="product-list"></ul>
    </div>
</div>

<script>
    // 資料定義
    const data = {
        recommendedProducts: {
            "牡羊座♈︎": ["貢布粉紅胡椒風味巧克力70%", "鹽之花風味黑巧克力70%"],
            "金牛座♉︎": ["深焙咖啡風味黑巧克力70%", "祕魯黑巧克力70%"],
            "雙子座♊︎": ["ORIGIN #1 黑巧克力70%", "祕魯黑巧克力100%"],
            "巨蟹座♋︎": ["祕魯牛奶巧克力50%", "紅烏龍牛奶巧克力50%", "台灣龍眼蜜香烏龍牛奶巧克力50%", "鹽之花風味黑巧克力70%"],
            "獅子座♌︎": ["輕焙咖啡風味黑巧克力70%", "貢布粉紅胡椒風味巧克力70%", "祕魯黑巧克力100%"],
            "處女座♍︎": ["大馬士革玫瑰黑巧克力70%", "台東洛神花白巧克力36%", "祕魯黑巧克力85%"],
            "天秤座♎︎": ["多明尼加黑巧克力70%", "台東洛神花白巧克力36%", "祕魯牛奶巧克力50%"],
            "天蠍座♏︎": ["台東洛神花白巧克力36%", "深焙咖啡風味黑巧克力70%", "祕魯黑巧克力85%"],
            "射手座♐︎": ["祕魯黑巧克力85%", "深焙咖啡風味黑巧克力70%", "台灣龍眼蜜香烏龍牛奶巧克力50%"],
            "摩羯座♑︎": ["祕魯黑巧克力85%", "台灣龍眼蜜香烏龍牛奶巧克力50%"],
            "水瓶座♒︎": ["輕焙咖啡風味黑巧克力70%", "祕魯黑巧克力100%"],
            "雙魚座♓︎": ["鹽之花風味黑巧克力70%", "多明尼加黑巧克力70%", "ORIGIN #1 黑巧克力70%", "大馬士革玫瑰黑巧克力70%"]
        },
        planetProducts: {
            "太陽☉": ["貢布粉紅胡椒風味巧克力70%"],
            "月亮☽︎": ["鹽之花風味黑巧克力70%"],
            "水星☿": ["輕焙咖啡風味黑巧克力70%", "台灣龍眼蜜香烏龍牛奶巧克力50%"],
            "金星♀": ["大馬士革玫瑰黑巧克力70%", "紅烏龍牛奶巧克力50%", "祕魯牛奶巧克力50%"],
            "火星♂": ["貢布粉紅胡椒風味巧克力70%", "深焙咖啡風味黑巧克力70%"],
            "木星♃": ["多明尼加黑巧克力70%"],
            "土星♄": ["祕魯黑巧克力85%", "深焙咖啡風味黑巧克力70%", "祕魯黑巧克力70%"],
            "天王星♅": ["祕魯黑巧克力100%"],
            "海王星♆": ["ORIGIN #1 黑巧克力70%"],
            "冥王星": ["台東洛神花白巧克力36%"]
        },
        suggestedProducts: {
            "女": ["大馬士革玫瑰黑巧克力70%", "台東洛神花白巧克力36%", "台灣龍眼蜜香烏龍牛奶巧克力50%", "紅烏龍牛奶巧克力50%", "祕魯牛奶巧克力50%", "祕魯黑巧克力100%", "祕魯黑巧克力85%", "貢布粉紅胡椒風味巧克力70%", "深焙咖啡風味黑巧克力70%", "輕焙咖啡風味黑巧克力70%", "鹽之花風味黑巧克力70%", "ORIGIN #1 黑巧克力70%"],
            "男": ["台灣龍眼蜜香烏龍牛奶巧克力50%", "多明尼加黑巧克力70%", "紅烏龍牛奶巧克力50%", "祕魯牛奶巧克力50%", "祕魯黑巧克力70%", "祕魯黑巧克力85%", "深焙咖啡風味黑巧克力70%", "鹽之花風味黑巧克力70%"]
        },
        houseSymbols: {
            "1": "自我特質",
            "2": "財運",
            "3": "溝通",
            "4": "親屬關係",
            "5": "慾望",
            "6": "外在群體",
            "7": "權利義務",
            "8": "一個階段的結束；階段獲得的結果",
            "9": "跨領域",
            "10": "事業",
            "11": "社會性",
            "12": "業力"
        },
        nodeEffects: {
            "北交點☊": "需要開發 ",
            "南交點☋": "應該捨棄 需要開發 "
        },
        oppositeSigns: {
            "牡羊座♈︎": "天秤座♎︎",
            "金牛座♉︎": "天蠍座♏︎",
            "雙子座♊︎": "射手座♐︎",
            "巨蟹座♋︎": "摩羯座♑︎",
            "獅子座♌︎": "水瓶座♒︎",
            "處女座♍︎": "雙魚座♓︎",
            "天秤座♎︎": "牡羊座♈︎",
            "天蠍座♏︎": "金牛座♉︎",
            "射手座♐︎": "雙子座♊︎",
            "摩羯座♑︎": "巨蟹座♋︎",
            "水瓶座♒︎": "獅子座♌︎",
            "雙魚座♓︎": "處女座♍︎"
        }
    };

    // 當表單選項改變時，更新查詢結果
    document.getElementById('selectionForm').addEventListener('change', function () {
        const constellation = document.getElementById('constellation').value;
        const planet = document.getElementById('planet').value;
        const gender = document.getElementById('gender').value;
        const position = document.getElementById('position').value;

        updateResults(constellation, planet, gender, position);
    });

    // 更新查詢結果的函數
    function updateResults(constellation, planet, gender, position) {
        // 清空原本的內容
        document.getElementById('nodeEffectList').innerHTML = '';
        document.getElementById('houseSymbolList').innerHTML = '';
        document.getElementById('recommendedProductsList').innerHTML = '';
        document.getElementById('suggestedProductsList').innerHTML = '';

        // 南北交點影響顯示邏輯
        if (planet === "北交點☊" && constellation) {
            document.getElementById('nodeEffectList').innerHTML = `<li>${data.nodeEffects["北交點☊"]} ${constellation}</li>`;
        } else if (planet === "南交點☋" && constellation) {
            // 根據對宮星座來顯示南交點的影響
            const oppositeSign = data.oppositeSigns[constellation];  // 獲取對宮星座
            document.getElementById('nodeEffectList').innerHTML = `<li>應該捨棄 ${constellation} 需要開發 ${oppositeSign}</li>`;

            // 顯示對宮星座的推薦商品，去重
            if (oppositeSign && data.recommendedProducts[oppositeSign]) {
                // 去重顯示對宮星座商品
                const uniqueItems = getUniqueItems(data.recommendedProducts[oppositeSign]);
                uniqueItems.forEach(item => {
                    document.getElementById('recommendedProductsList').innerHTML += `<li>${item}</li>`;
                });
            }
        }

        // 宮位象徵
        if (position && data.houseSymbols[position]) {
            document.getElementById('houseSymbolList').innerHTML = `<li>${data.houseSymbols[position]}</li>`;
        }

        // 建議商品
        const suggestedProducts = gender && data.suggestedProducts[gender] ? data.suggestedProducts[gender] : [];
        suggestedProducts.forEach(item => {
            document.getElementById('suggestedProductsList').innerHTML += `<li>${item}</li>`;
        });

        // 推薦商品邏輯：顯示星座和星球的商品，並去重顯示唯一商品
        let recommendedItems = [];

        // 如果星座和星球都被選擇，將兩者的商品合併並去重
        if (constellation && planet) {
            // 如果星球是南交點☋，則只顯示對宮星座商品，不顯示原選星座商品
            if (planet === "南交點☋") {
                const oppositeSign = data.oppositeSigns[constellation];  // 獲取對宮星座
                if (oppositeSign && data.recommendedProducts[oppositeSign]) {
                    recommendedItems = getUniqueItems(data.recommendedProducts[oppositeSign]);  // 去重顯示對宮星座商品
                }
            } else {
                // 如果是其他星球，則合併星座和星球商品
                let constellationProducts = data.recommendedProducts[constellation] || [];
                let planetProducts = data.planetProducts[planet] || [];

                // 合併並去重，使用 getUniqueItems 去重
                recommendedItems = getUniqueItems([...constellationProducts, ...planetProducts]);
            }
        } 
        // 如果只有星座選擇
        else if (constellation) {
            recommendedItems = getUniqueItems(data.recommendedProducts[constellation] || []);
        } 
        // 如果只有星球選擇
        else if (planet) {
            recommendedItems = getUniqueItems(data.planetProducts[planet] || []);
        }

        // 顯示商品，且若與建議商品重複，顯示紅色
        recommendedItems.forEach(item => {
            const isDuplicate = suggestedProducts.includes(item);
            const listItem = `<li style="color: ${isDuplicate ? 'red' : 'black'};">${item}</li>`;
            document.getElementById('recommendedProductsList').innerHTML += listItem;
        });
    }

    // 用於去重商品的函數
    function getUniqueItems(items) {
        // 假設每個商品是字符串，若是物件可根據商品ID來去重
        const uniqueItems = [];
        const itemIds = new Set();

        items.forEach(item => {
            // 假設商品有一個 "id" 屬性，作為唯一標識
            const itemId = item.id || item;  // 如果商品是物件，使用 item.id；如果是字符串，直接使用
            if (!itemIds.has(itemId)) {
                itemIds.add(itemId);
                uniqueItems.push(item);
            }
        });

        return uniqueItems;
    }
</script>

</body>
</html>
